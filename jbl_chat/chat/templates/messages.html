{% extends "base.html" %}

{% block title %}Messages{% endblock %}

{% block content %}
<a href="/users/{{ user_id }}/" class="btn">Users</a>
<h2>Messages</h2>
<table id="messages-table">
  <thead>
    <tr>
      <th>ID</th><th>Content</th><th>Sender</th><th>Recipient</th><th>Created At</th>
    </tr>
  </thead>
  <tbody id="messages-body"
         hx-get="{% url 'message_list_partial' user_id other_user_id %}"
         hx-trigger="load, every 5s"
         hx-swap="innerHTML">
    <tr><td colspan="5">Loading...</td></tr>
  </tbody>
</table>

<form id="message-form"
      hx-post="{% url 'message_create_partial' user_id other_user_id %}"
      hx-include="this"
      hx-target="#messages-body"
      hx-swap="beforeend"
      hx-on="htmx:afterRequest: this.reset()">
  {% csrf_token %}
  <input name="content" type="text" placeholder="Type your message..." required />
  <button type="submit">Send</button>
</form>
{% endblock %}
